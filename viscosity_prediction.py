# -*- coding: utf-8 -*-
"""
Created on Wed Aug 24 16:03:22 2022

@author: elias
"""

import numpy as np
import pandas as pd
import re
import csv


def predict(modfile, tempfile):
    
    
    inp= pd.read_csv(modfile)
    temp= pd.read_csv(tempfile, header=None)
    
    #temp=temp.to_numpy
    
    x1=inp.iloc[:,1:158]
    #print(x1)
    
    fres=open('resultsfile.csv', 'w', newline='')
    headers=['Smiles']
    for tpoint in range(0,len(temp)-1):
        headers.append('T=' + str(temp.iloc[tpoint,0]) + ' K')
        
    write = csv.writer(fres) 
    write.writerow(headers)
    
    
    
    for row in range(0,len(x1)):
        print(row)
        predictions=[inp.iloc[row,0]]
        
        for t in range(0,len(temp)):
            rinp=x1.loc[row,:]
            #print(rinp)
            rinp=rinp.to_frame()
            rinp=rinp.T
            rinp.insert(156,'Temperature,K',temp.iloc[t,0])
            #print(rinp)
            inp2model=rinp.to_numpy()
            
            pred_value=viscosity_prediction(inp2model)
            rinp=rinp.assign(pred_visc=pred_value)
            predictions.append(pred_value)
            
        print(predictions)
        write.writerow(predictions)
        predictions=[]

    return predictions            
            
def viscosity_prediction(modelinputs):
    
    #print(type(modelinputs))
    
    if type(modelinputs) == str:
        print(type(modelinputs))
        inp= pd.read_csv(modelinputs)
        x1=inp.iloc[:,1:159]
        x1 = x1.to_numpy()
        x1 = np.transpose(x1)
    else:
        x1=modelinputs
        x1=np.transpose(x1)
        
    #print(x1[23])
    #===============================================================================================
     
    # Input 1
    In_xoffset =  np.array([[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[0],[153],[0.08]])
    
    In_gain = np.array([[2],[2],[1],[2],[1],[2],[0.666666666666667],[1],[2],[2],[0.666666666666667],[0.666666666666667],[1],[2],[2],[1],[1],[2],[1],[1],[2],[2],[1],[0.666666666666667],[2],[1],[1],[0.666666666666667],[0.5],[1],[1],[1],[1],[2],[1],[2],[1],[2],[1],[2],[2],[1],[1],[1],[2],[2],[2],[2],[2],[1],[2],[2],[2],[1],[2],[2],[1],[2],[2],[2],[2],[2],[1],[2],[1],[2],[2],[2],[2],[1],[2],[2],[2],[2],[2],[2],[1],[2],[2],[2],[1],[2],[1],[2],[2],[2],[1],[2],[2],[2],[1],[2],[2],[2],[2],[2],[2],[1],[1],[2],[1],[2],[2],[2],[2],[2],[2],[2],[2],[2],[2],[2],[2],[1],[1],[1],[2],[2],[2],[2],[2],[2],[2],[2],[2],[2],[2],[2],[2],[2],[1],[2],[2],[2],[2],[2],[2],[2],[2],[2],[2],[2],[0.666666666666667],[2],[2],[2],[2],[1],[2],[2],[2],[2],[2],[2],[2],[2],[0.00644849266483959],[3.22869153225262]])
    
    In_ymin = np.array([-1])
    
    
    #LAYER 1
    b1 = np.array([[-0.032436249283076160066],[0.035440404410157867743],[-0.031587302652290281946],[-0.040942166886159571393],[-0.047937476763355767184],[-0.037103282793884861945],[0.045420319385414617552],[0.041651634082237314061],[-0.022643096856101482817],[0.029338510568031099524]])
    
    
    W1 = np.array([[-0.13448417599143266954,-0.17415935971256146786,0.00049620143725313163932,0.0054500430905069039561,0.019315061470728450699,-0.1608664190210302436,0.15766543702471741417,0.089041548833410755215,-0.082443160100376278177,-0.092419675345066426564,-0.12568007482896179083,0.050750768575209118105,-0.01976686856730252434,0.018229070841684770488,0.016805130255312012572,0.044659399673190151858,0.038185355782548932591,0.014420287104632275449,0.024759712205002348123,0.019530075638190133591,-0.0028298684635548027565,-0.10930191690074461675,0.19760478990907162644,0.14399828625377752989,-0.00082517706197499172526,-0.04299483371166529927,0.0093712441321747181472,0.041627952733731883594,0.30943242143059357385,-8.492413733178829098e-05,0.22472837739816614588,-0.098639708757742000644,0.12652555670726675641,0.00045884717944620601569,-0.07822409572354395435,-0.018716418583838319994,-0.043608524165422851704,-0.16259006310000445605,-0.18525644055333850835,0.042625193151655471624,-0.049349516890525434165,-0.095921175355198132206,0.12133830966480124713,0.023477037610343854529,-0.1212393803032930234,0.02949911743728675026,0.065319666853971766751,0.018329598524641482066,-0.014663229756714532895,0.19899950282518910627,0.085763990837214976182,-0.13241339972660937097,-0.0050862098601125458122,-0.039882967094661207763,0.01292719769846271613,-0.008846291165949028007,-0.05560192019703900923,-0.029652661465337602081,-0.0064426311873530921204,0.020217050112673266848,0.0082006612224594602895,0.069910915783632981979,-0.13029189483169065222,-0.089460047680450224816,0.13035131348927245232,-0.25735697315752015246,-0.079239415911728380837,-0.025253880007577073769,0.042550835151203933449,-0.014142787461054989739,-0.033489251193966208808,-0.033762701259706935641,0.098163882208107691718,-0.032661562030930561817,-0.18458565239211247033,0.024233701366970013258,-0.062974534827598752096,0.00846146201388101038,-0.0020500864587703810683,-0.04075923453396915197,0.23053798662425020738,-0.39761210690289211511,0.049267786295034185495,0.054862752540426232284,0.014368625022653815776,-0.045694834533218313399,-0.034733114163713760258,-0.027213544588409223357,0.018416860300607594547,-0.023331061357732250233,0.45922638610255300806,-0.089824450290776555739,0.066565036512486561171,-0.098744622001920953624,0.057258262215774576032,-0.14896952272282446006,0.03858380487931568209,0.015928566355517918829,0.054509913805497418882,0.0090590488235915474918,0.055878572427801087574,-0.088097010210087062232,-0.010810014818159475666,0.052333704036134166826,-0.026777466624216112595,0.074876683556547321552,-0.23595182930967895096,0.026974997728321670892,0.013292369273743139327,0.022480032526489661382,0.033200626165230617826,-0.18421774112425068348,-0.23948682289841594084,-0.022890175433509525604,0.070793190037006958892,-0.16357671294750703028,-0.043323865429919457271,0.0034446823301705728655,0.016398353009535033414,0.0015312167583600227398,0.0097119678073198881935,0.019189100940261136913,-0.036501114621705715857,-0.22655039181239305934,0.00092196867823896163589,-0.0045882414616932364407,0.0068100259510531814533,-0.028992873581247080583,0.0052950056725811055908,-0.0033917254153194758073,0.0098392406574435084532,0.021974807853022308018,-0.065088805592741674766,0.010112541902317499429,-0.032266491256020213285,0.0229961027510487033,-0.049936721908841567863,0.025479736642371363792,-0.090332410628541262576,-0.063731374118550954133,0.0065881513406490198326,-0.0055265299617376544353,0.0046350745853758253817,0.02371869914657057099,0.023718699146570564051,0.020413543012199306809,0.020413543012199303339,-0.0072612404338992528677,0.018905019859850515779,0.019823950212899250217,0.0017886386374822153995,0.033022922673285264039,-0.02720941196791763772,-0.0067783667337403740935,0.028531634227928578951,0.016885398100610859301,0.93416384877546365662,0.51912017502665386282],[-0.01271306981835284601,0.072479416725311038294,0.045881653830751233103,-0.0011465350175708477302,0.15739799516425173609,0.014781571409829471,-0.17166966082960150031,-0.18118652711317878579,-0.041659641514027082043,-0.033151945077592864797,-0.035403108323852225392,-0.060005329331257080405,0.027890445985140316365,0.00061981004103326840706,-9.9604719234102143252e-06,-0.014086620452751290669,-0.075783185489247381628,0.0062627433189337703215,-0.01042075765832715592,-0.017280489556183342009,0.0091738851511805122318,-0.086427456871041946629,-0.057854081646525376548,0.045605679223355261032,-0.0056252904544709216375,-0.040986674080550900001,-0.038233738431841739203,-0.0012349925818776702566,0.0023579417362193564288,-0.0046057760821977024313,-0.10140356641215085565,0.010478629435945078369,-0.038623293608836553603,0.00029834638368527859617,0.17669492949350526501,-0.025272503063700713088,-0.038468152904613701903,-0.0019892655106147167851,0.067626536222094288386,-0.024364454949862512229,-0.055466436893808250541,0.079008662010992616875,-0.013920430904276489756,-0.0490138740669694567,0.036319575001760584509,-0.039572264711715342267,-0.071329807075115186921,-0.019919323039873707698,0.023665659582958676471,-0.054243842183166107729,-0.048424053558811276654,-0.077927026439123012191,-0.0063654603686394851253,0.0183185920126579041,-0.0068398976468136843745,-0.0037277705551075563176,-0.1159859404779895603,0.014995127562616472963,0.034228839664698973433,-0.016378048206444180412,-0.0048012178734653174206,-0.0095192023826354658922,0.040137121992925489655,0.0044546943339496851075,0.12612415086030934197,0.071809563225364067551,0.049609706754462301603,0.025523067830872148837,-0.019912603682730452975,-0.007671955721810915993,0.0011981869217363579853,-0.00047291222110095609442,0.044020791954904082977,0.0069346256568536867107,0.020774248454562452282,-0.011541491581711199252,0.098526281353624053927,-0.0050657256144774742007,0.0082707237255675511434,0.044118071440770956215,-0.023606487852827894025,-0.00205776847152531377,-0.005642902501028615285,-0.029566367311982161975,-0.0034738603357147750453,0.017933040868193271533,-0.034435232924492069351,0.02580282532081092442,-0.008146905982107805963,-0.008920435129699857621,-0.058672007029856053373,-0.011632132401588316309,-0.04102006437857294574,0.025880907186668498238,-0.0022164419553313183774,0.032142132285531026248,-0.011249752467876310627,-0.00069848085011279788595,0.015920052782202050168,-0.0041129960467172991395,-0.022588752230781508623,0.0073825507533566980811,0.0068287440283219180345,0.0050519691968617941313,-0.015162307035465741323,0.00065870996605712551532,0.10267136040154679899,-0.02132278056510631889,0.0025796997106886146965,0.0072765195391526933666,0.0050260562837254035146,0.087435387945133280496,0.10096070373136624421,0.0026789967855342091893,0.082750839821607774516,-0.030527504838471445497,-0.022379527231151868233,-0.011182305879413701605,-0.010137752479861093444,-0.0066481797318832100072,-0.011569905332180807286,-0.016919545320533673632,0.002223444192232786748,-0.022872006864967736606,0.0038609372856207467214,-0.0083662109978831951385,-0.01433918489063029135,-0.11485922807391141243,0.010638338830918766739,0.012355451519097044796,0.0053558456108867159157,-0.025155189780871431426,-0.015208559743208047155,-0.011495587994275040591,-0.00029416940191930328113,-0.00070571861791577609069,-0.00013634178100659116077,-0.012931902083684373994,0.013377359036752963645,0.0088715937818154271682,0.0076646727550407208959,-0.0034945903964069022045,-0.0058233328918741236735,-0.0067109917611609054902,-0.0067109917611609020208,-0.0037285250539563219441,-0.0037285250539563254135,0.01620974934731034614,-0.0033771244201104759323,0.0021103825689811370019,0.014774101999523446202,-0.018156932064216525086,0.029639958905100561443,0.022388686237452840033,-0.019744635532767080416,-0.016637558982612245251,0.35126075887890512162,0.24086901413417824425],[-0.20728861152052127648,-0.10129457292056695539,-0.069507152654210146991,0.002866139192551366531,-0.14760468929349987444,0.0022147658075124072516,0.1263672561678647055,0.039191320282017133581,0.03985557402847372116,-0.0069337785755780156211,0.045102331218580281325,-0.13233295219312385393,0.042365201313125641636,-0.0027852929786312537012,-0.0070864266447550200434,-0.010369929799490491124,-0.0058564377412815595003,-0.016498583611973254015,-0.0011061138340028549894,0.015684827313798312132,-0.020154718825062818699,-0.059857202328858376272,0.042416184784421134824,0.16118865116230443602,0.011160447116550675783,0.20503558687240347469,0.014789764053719820641,0.030357381102355151387,-0.019472081330091615958,-0.009018032133849648857,0.12338215068273408748,0.015488833269531505216,-0.029045899519490585988,0.017464129804352183928,0.031930011206076851227,-0.002686451823358125459,0.037197856202302828632,-0.0013251101640666194514,-0.13709526174424471745,0.01730404157139187743,-0.098849893029456764593,0.025827626866763302854,0.10130841143901263279,-0.075494133922409362158,-0.0028550555263240260349,0.06052554992594671307,0.013537655258163651048,-0.021017824371252435967,-0.023086064367445174872,0.023852585780505631413,0.093090136928900613089,-0.0099521432514702978106,0.016809553227082479204,0.0056716144126352291063,-0.017647394372187159839,0.010600104575402424442,-0.017717428078110955547,-0.00036573409825525022773,0.0073626216294961866968,0.0096133930739260228804,-0.0079177017413538663959,7.716597368633002006e-05,-0.18745534097255286965,0.0051389819716980518136,-0.073568667106405305489,0.10342048963267949646,0.025219812527176140721,-0.020383266755912114732,0.15358774130032198935,0.068798901551645724739,-0.050923658061749997594,0.018890160923236445217,-0.076907482220890777125,0.0014064362456977775023,0.048217677277827997173,0.020736765359528761682,0.0080717042044155060815,-0.001387186953520223821,-0.0029173212141429820561,-0.049967051289105023082,-0.041523100493691705859,0.2334045249664606636,0.0040902097486995876024,-0.022960230311623280874,-0.0011230808916338453577,0.011662371860628564443,0.09394720169398841636,0.030517361121588038042,-0.0031125769311726942182,-0.027296047969010407003,0.052003155511862339533,-0.19278427289815003309,-0.089218819907794455482,0.059805189695958785312,-0.11164251508273075053,0.063163467761921179844,-0.017132691331014422709,0.028520090491449340969,0.092960859644475354879,-0.02316191576042803818,0.054226785595530603568,0.021751140965029894941,-0.0084711639993115782354,0.045603619578737264462,-0.018445379389716309165,-0.032575413517008468267,0.11498594930356549615,-0.039341437320726799221,0.0066877194361631229352,-0.017496077171582118809,-0.0012021610330187964492,0.15421430871404184781,0.10868204305725050196,0.013760924882900378574,0.029739020847831556388,0.038530069543346423533,0.0069145042869270881281,-0.0010143492963270901459,-0.0044766340620041537163,0.010205785953361816779,0.016181983984708495777,-0.01982516924036990813,-0.007986589940128097434,0.16485750275481500515,-0.019849691918531656154,0.018248128280941969953,0.0095979049660526762067,0.058976491836081633424,0.016078090254916060226,-0.0067337987391783366356,-0.021334898735166179379,0.016617194748502692181,0.039664291824768792283,0.0084457385473748463472,-0.051498284812978321889,-0.023628426849561543627,0.027832095687577655674,0.01091937780968322419,-0.016292977393798233759,0.016596462275823977567,-0.014040796324397707834,-0.017811869085074066854,0.027780449160541734882,0.00058530121019403924271,0.00058530121019403956797,-0.0020595470102622139355,-0.0020595470102622139355,-0.029003473398137229883,-0.013891796305352846833,-0.01281781871206875284,0.0029143642319093381043,0.011785062351817235729,-0.0078866190529900698919,-0.0087891253026471539284,0.01717869915435266126,0.0084599215437450147465,0.54747307677654599711,0.28281213112733660786],[0.038919086950118197965,0.043880611242956876761,-0.064343676629300947112,-0.013022265815849110374,0.21692246484805211004,-0.015975897644597114589,-0.32907087294544967726,-0.14340193038149362526,-0.044943392444316630774,-0.0093666103274547482527,0.29935051848502647331,-0.033736267298459146624,-0.033705944498405880638,-0.011895891575954956054,-0.01375863107587634547,-0.0011271108184192626597,-0.059431410450445310012,-0.020582611321503879731,0.0084997080570954897105,0.014860618968332843515,-0.021482598857524858732,-0.19254382561180613531,-0.018323576836968991782,0.072861355280048306637,0.0045249557972274088644,-0.005260198464135743511,-0.080660494219205125521,0.0009343370566496102779,0.02166638986070689582,-0.012806844917183285437,0.21391389425241663647,-0.14032209994724006985,0.030089083769794654211,0.0014808200968754430937,-0.11005185207460445318,0.023814044219377192985,0.02813476797201077198,0.018216591946712698546,-0.097446894700344899309,0.019269369571303939653,0.013407052499648621988,-0.10653145364352673008,0.09925916604117718256,-0.0080929943939280855197,-0.012291050575009865656,-0.057295391703387585358,0.0036744228150901807849,0.0053937141931464770844,-0.049529060112869928434,0.025089365298387976411,0.080961130738303771492,0.087564285067374472704,0.0020027681242176880415,-0.027054869280193034192,-0.011260346384373920783,0.0042900134302683900003,-0.023941206889353031789,-0.026112374256077798551,-0.024648595285426712354,0.005944890449624144757,-0.014652070151568883857,0.015238744470181355903,0.24603685326303173508,-0.01515100177915986758,0.016695012856365917808,-0.079376864195789625933,-0.072300629924908529911,-0.0529472344823897767,-0.070178516489686273983,0.01374017443009256309,0.06644660901605786707,0.0030793254182502009103,0.047278287473545642372,-0.01914477240220258808,0.0018812331285392761785,0.012695554965265427871,-0.011982761195413344987,-0.0083602060004536390969,-0.016455376927365625989,-0.078696963937940317413,-0.0097806648038193354233,0.11313104414134039777,0.0030809405978650282118,0.0082619867210633607391,-0.0039017918756936390695,-0.019824650918766093671,-0.14683953934364718519,-0.034103193135416050297,-0.0028112096422869808227,-0.0052944438916012921681,0.0014422495755827390712,-0.027451822113881502174,0.012011588233039044785,-0.0012612250259690265582,0.061489715048261145425,-0.0078300161257617642563,4.5743680884528716436e-05,0.0080844092267135896079,-0.0034524365032347356999,-0.017073436784364768443,0.0057553591872851082509,-0.0077254183383037621294,-0.015432973553099381403,-0.0076667204756764219947,-0.014278343872438807594,0.039441180651216656283,0.19678178790224903905,-0.012091731540988786414,-0.015753579499003585174,-0.025704159736133207204,-0.0070437409374158330491,0.24062761496940665573,0.19038485421159742628,0.034233427176726539953,0.08270229079915179804,-0.0040927651078544154475,-0.010591703018120667348,-0.0085269426188201748185,-0.0059019610773442861967,-0.0054810464127541414642,-0.0046307902543182150046,0.0035374467249578069733,-0.0064559904135115999541,-0.074564369854253534364,-0.0038893090439258270335,0.011051534082941839171,0.0073856794111706158129,0.10778357143024243359,-0.0095226063525347282718,-0.024341366813024865878,-0.027534599028252965819,0.022656799690514813767,-0.014355011112666687598,0.0099891525588337356373,-0.012208609672709416424,0.015172972440583647538,0.0076371092045513858104,0.0070993163872131448411,-0.015903603971583323007,-0.0095762989388706361987,-0.028805075202289479736,-0.022153858490287406391,0.0081995748960333372096,-0.0023984990191761204441,-0.0023984990191761195767,-0.010864302814834339919,-0.010864302814834339919,-0.040586160367210577515,-0.014544811243135020301,-0.016417890773925580827,-0.019600428796853933133,0.0083124907118479109819,-0.044027832701269462023,-0.029953035300912238953,0.018408134701474412886,0.016289126704536988771,-0.21705698105335519132,-0.1868410217093269543],[-0.26088160606839339017,0.034242106260438283372,0.087567315628231709446,0.011373456674118704104,0.14295909142067339537,0.0654040884868151845,0.17288047401388592639,-0.10600587317303050705,-0.012226820664393915974,0.015711242124151529598,0.19757559957801543171,0.055696874531199334901,-0.039640328484292136624,0.022682612303524255642,0.018458028348484811776,0.054874890107742414769,0.09818960482127078726,0.014210021150155984632,0.031872492913883242183,0.032744251224889900365,0.0090241451416151717557,0.05432001431687914772,0.0073870466172650407072,0.11084780947113238858,0.018867965619034966079,0.067435498447204048067,-0.37623216552188498696,0.067146596662293583924,0.13620319913207376561,0.070588736528684151161,-0.078883593786965633399,-0.037265626971009574442,0.0078989625245698275036,0.072731392970678293564,-0.048397075585218232718,0.10890343351339519529,-0.0048546253274164025832,0.038206161278513534052,0.27640100764392838695,0.037815546761382372309,-0.086149075963834892411,-0.12600621195611513836,-0.10023874127071197293,0.023836113225623501571,-0.043671475982805227356,0.012319872417026511355,0.088573426679900688074,0.017354931012885654873,0.0041532555989919174924,0.028373390752832489126,-0.074977331186946244435,0.041828622203534247814,0.042942821363330462014,0.02097466773424178782,0.028359497898536381588,0.021870639543400738347,-0.00029408799686122817207,0.0012248850418884224111,0.0064598372850882901722,0.027743077340298061967,0.016193610452055560295,0.011629372812862292033,-0.049663194353447438767,0.023460190843566919999,-0.18947822112754095225,-0.065714612300329378058,0.13727207407663144512,-0.014624439864802878108,-0.054095196029909045632,-0.012370575099904433658,-0.012041629206339136623,0.0046385135321530684971,-0.0076772186066409791802,0.023061987126730500164,-0.041385080742158845968,0.030712777088706920414,-0.03175066966440119598,0.020905188938169352864,0.0033070723361428573488,-0.044227845244584063078,0.1110757708042370423,-0.13819458897869915659,0.045130544595692163867,-0.0023938866144125833281,0.030776844733317213626,-0.041720567353317090931,0.024547725917461304251,-0.023391812418486642583,0.027711635268745194588,-0.047653077263154361431,0.076973480753462691917,0.15666045101511297255,0.053328941248205127823,-0.12428155251531128322,0.15436226090313562298,-0.078293934801273751267,0.0065717116367346355491,-0.022386616749602121501,-0.053336277167642505426,0.025908648066648987812,-0.013691073445724550803,-0.038567658548806803276,0.0122807767067984238,0.0015949954514193468748,0.033009313185199881668,0.072222143991405515773,-0.12846207343498011744,-0.0029691926214727784594,0.0073546654090824344074,0.01144315701885910419,0.017232860754223779803,-0.11728919638690440963,-0.129400679816903591,0.041239475663823930984,0.032780576370931846508,0.11538482389181105303,0.00016817008545228520578,0.03465150417822022294,0.024358503473291062691,0.0022480533287844899418,0.017619403069890453295,0.017624424620457455892,-0.03235760165337538824,-0.24364194786332149523,0.045665028707245917949,0.017426525837080996534,0.021148121818871202376,-0.10968363900157855617,-0.00095972025475057789849,0.0082070944870132975929,0.019595934589145502097,0.041628594819514815051,-0.062314325232492868978,0.027287633516084472407,0.0110126749465804738,0.047541105423262716712,0.0077465411834338271727,0.02819811381703863154,0.047479440483672301354,0.030694386433318933405,0.016520199057255133962,0.018255208995422995966,0.012835966633025554587,0.025425560784007778664,0.025425560784007778664,0.020332894908400886425,0.020332894908400886425,0.0052753138133633976914,0.020139116432973634685,0.023769588955953331599,0.020813296661123515535,0.03800362714274743009,-0.016776082772457526215,-0.00037816411180458366428,0.035486230819448648377,0.02949985179627081372,-1.1770992369473840533,-0.21378840707888438488],[-0.070320869662980983739,-0.19914408683978582215,0.047461197023965367991,0.0033543313845889695043,0.10708781292321149781,0.0076850583867540097141,-0.19267002313876060993,-0.050878873186515738425,0.1267752809313757445,0.09497753724713876855,0.065912675856199781643,0.1002405177286865845,-0.075933194749874657892,-0.010894296957058709555,-0.0067027187848615402133,0.020887829978235038231,0.056115062451868091831,-0.01967979382997713661,0.012491509346246669823,0.018677839865236019884,0.0021655778708431923894,-0.016322320197115724322,0.21262444855892156936,0.1816884171713048779,0.022820352190942753273,0.15130962869884959088,-0.077491160301044650915,0.07244580350490570364,-0.38126916749677630669,0.065445051945127966087,0.06817260373340983115,0.012268833471901456969,0.028989933119674994588,-0.0050553832816088110219,-0.014631392075179551829,0.018204528727117166159,0.044899871819491933567,0.072554154578180540813,0.087776718604567788296,0.010008617915122161243,-0.049734340425856782275,0.052689164152010518893,0.058030769586228291013,-0.014570758300405377283,0.10013624776603403943,-0.066619563625461217238,-0.13946691719794604425,-0.031756835657855683741,-0.036820410877483347734,0.23957548028823397179,-0.023600387883541698586,0.13362347532860624488,0.042508544755423101347,-0.0059211125040643606404,-0.020813259954821267811,0.023214375117464453729,0.086543749762017049831,0.0011288446978977412748,0.017037767290416571536,0.011233309741472713439,-0.0066219352783602166215,0.04272744216806475398,-0.073285947974834564356,0.0029605622535983965385,-0.040828842841606725889,-0.28569229957560765554,0.06755135262770642357,-0.0090409844696452638241,-0.10690339891320024823,-0.042348470576030368406,0.13125435411930103102,0.013772641054430106652,0.067593480082463908154,-0.016687057618570297346,0.0002256866730180945497,0.0078946859618084664484,0.034080036995480809947,0.0021774211837311003431,0.010693966014661925382,-0.0016332711341457042519,-0.069337866471670006607,0.087964951114122197362,-0.022561502015722521147,-0.03208638515952064868,0.017172732302769670026,-0.068226664666446126817,0.017672353269616469795,-0.080100880977401131555,-0.020270419510774517757,0.022849889403565463997,-0.28643103617611692657,0.056039906872134732929,-0.12825560718291684204,-0.19192695065363932216,-0.067254981348689263365,-0.23623988121674807661,0.0047932589651775870526,-0.052083014242972430763,-0.10481338658128709629,-0.01278265974151258054,-0.014646316298282391344,-0.1254905562557066534,0.011302790268183570896,-0.037088717955334790655,-0.031987815814772876943,0.13267949143169532888,-0.16385738522658954697,0.015605130989559502092,0.00043309612268962853227,-0.039942338198063281896,-0.026924170413009543973,-0.11167036248397892162,-0.16998386048231634016,0.037621631242320867361,-0.0069818760144428814937,0.067370107445422738879,0.052833163639343372342,-0.031093988315340735651,-0.0070913120661644365658,0.011863568365074884936,-0.020272147558327929806,0.019402019628977456439,-0.016885016223369492261,-0.0097918638304299206176,0.024566834107724984382,0.015898767637227927824,0.015519737604579589979,-0.38420171835573668773,-0.035756145722469927228,-0.0042337366322946880584,-0.026348057643441242376,0.026740506439785420578,0.0063575005579139106868,0.023451940402891908316,0.0018856393626121004375,-0.017173720354531057247,-0.0040929045661538187781,0.018168200828696402099,0.084915069430075582058,0.078839696432908459856,-0.029104339935252170751,-0.022939102760889343996,0.029172965347270315289,-0.011305071434694453913,-0.011305071434694455648,-0.0052738529615563309663,-0.0052738529615563266295,-0.032579822769526610438,-0.029144425105889715244,-0.02368271210761606349,-0.02270944116513860106,-0.004101698551736322404,-0.038391479733045984213,-0.0084683314010989118453,0.0094012938356680033486,0.024130095127006055689,1.0298888168306952196,-0.25409245124371659941],[-0.30879505136747936733,-0.066258247311351117781,0.021263599102325354134,0.023403055079747766415,0.19111843122599581068,-0.060330196795255856823,0.088781586833575343309,0.045579749732691195174,-0.052380868650093261041,-0.042959435092897353681,0.075828093642005295338,0.013116647108206445915,0.042318193299700004872,0.029328314655997278493,0.024919485256999437256,0.0060937290395176946581,-0.081766057854756046819,0.035532588027243426632,0.00025014750008626866241,-0.013996804163380583211,0.027872336589151714553,0.033481712525798221214,0.20858929039857637688,-0.02987026411059722289,-0.0081640726969390304407,-0.049407268345177030033,-0.29307490541523090188,-0.026202792360010933315,-0.13287929575016807493,0.08114483013470989714,-0.14627940290250734945,-0.12178973804066015041,0.066558980114521396065,-0.018954482608271754074,-0.14684295712742170825,-0.023147761562657305501,-0.015796325008120341155,0.011895727548541354737,0.087074760938507550501,-0.0090667230995251611725,-0.026477007294143588279,-0.15176214006069990714,0.16756700469461485725,0.036446905559842486533,0.00043113523499354515587,0.035029300918067080017,-0.084220788056181855596,0.0045419166034527955547,0.07120851297124071444,0.055578463034581082614,0.058306118303545734216,-0.0051169701622434810018,-0.017839171840586864892,0.0018200689296897973584,0.024792369417420089678,-0.0027348712219611407033,-0.15761631436363518488,0.035562661374435956818,-0.033067187889416094215,-0.0016833751818906038996,0.023044651248089353945,-0.028021735948067602595,-0.026313924551209136315,-0.026626412140334940193,0.042085784536281242718,0.091099906107363667895,-0.095314499961590512522,0.070754814465369228471,-0.22235778197180475213,-0.014875959663069517058,0.018466181144519193402,0.0023215659122412229259,0.02413983707894027872,0.013257028579771863025,0.010396369032655004491,-0.015445337826733698816,0.12769054278641625566,0.024900829570814402014,0.014563760716449433014,0.098632760586790449442,0.15902284001272617986,-0.11719855202900375524,-0.066821579409425471696,-0.031909663002465595005,0.011508434825201002694,0.017365382148318554006,-0.15007513972511163369,0.046674674985288745754,0.013432749837819423985,0.0043612389228775538114,0.070798011709014133097,0.25274635743377532604,0.025669780048208617335,0.026931621349044931185,0.044482169695825087008,0.02459028395360063346,0.12717697317343690244,-0.0015248179802075381099,0.01454322178864106245,0.037052056454266367458,0.033267257432868901912,0.015357626691630772708,0.016474532883238936914,0.058685697513844149731,0.024681731843931565412,0.10851188749425449975,-0.016137337030788369979,0.033472704051673851655,0.029824200629682846159,0.048588472645579375286,0.021637534689020292145,-0.070969837165264323953,-0.015844532516197513267,-0.0716205389321430963,-0.10083348670456265816,-0.18182725963146401105,0.036349511409615578583,0.0088572962827432530353,0.015740867632988476271,0.028915490189594845322,-0.039512973051167195326,-0.012645015101500669749,-0.0011985663730533484966,0.098608284749218302889,0.015701798883356911374,-0.019864716625155022511,-0.0041493777838822560808,-0.13815618566084184038,0.0088260050939830813482,0.031063554337601814725,0.044701883159433630777,-0.023820050567219405724,0.059926656050312929191,-0.012968861828182276161,0.0031125822818156021268,-0.022710188360951451964,0.0014438138414599405255,-0.0007338502685177526047,0.0084367149717873030773,-0.017082321545283222358,0.041625909139238428947,0.033653018904588119509,0.017566146249701687643,0.014411511556771958512,0.014411511556769333875,0.026205795314945070501,0.026205795314945629082,0.054454040782246165842,0.033288410859853505286,0.031756818966332457654,0.0030804382404552724598,-0.00077955036894480293341,0.047224464088587887745,0.032777824117359792566,-0.014850706504353208479,-0.022413989891097413354,-0.15342166696747971955,0.21793750231113584448],[0.082541781471888314714,0.0472000439128058627,-0.039354917093254039584,0.016923385032319913229,-0.19283075409478303563,-0.0022937605075029161503,-0.045664831944268451103,0.10817340398740216134,-0.028224393685730455456,0.030167437769570405737,0.0841923693049528854,-0.11129409058142007705,-0.0081934811589784526525,0.010543487792252798779,0.02717336762692079688,0.029563729781986018003,-0.10576180531681085573,0.026536786856770622905,-0.0066893110458413878455,-0.011864211329986109125,0.039731471542563429056,0.027246519322552311543,-0.16510105555434639868,0.010544402390171063455,-0.0026110878730537024663,0.25283638081058501523,-0.063558409083705927345,0.004289501454351126418,0.012031858983811398109,-0.017609749693358905942,0.21317656448108318612,0.060059284347143762628,-0.075241672248285054736,-0.0034718512471182036948,0.073263062470630177514,-0.014738988249088747634,-0.041709008931746199833,0.026367969302400359743,-0.17611555780968660145,-0.0099063045878936238642,0.027079357993201748356,0.10761772701975066968,-0.074630172107393741299,-0.041258997069121339241,0.042226757896475307363,0.01649070643613626333,0.083102910539001595414,-0.013862489921337780782,0.072395705896484155439,0.014401989602398860418,0.34521753123096060589,0.071048813872849322926,0.024193330184819502454,0.051520767620433456646,0.0024882719254609598353,0.0059333255964508025207,0.071753566109772473625,0.030875676779970377683,0.065851447599254805954,-0.00027930449072320764166,0.030277369317809332827,0.035845146165942372296,0.16342493423217499537,0.069850561261664223522,-0.097643424936823611238,-0.12205493576518254562,0.10797561175931624788,0.070019341181779687355,0.28566524275819976664,-0.055819286120185461486,0.12053430114992762234,0.0053812581870238069062,-0.046172498578209549003,0.025999776584303628535,-0.053746602361829758088,-0.025907711245809490752,-0.18269774343284791995,0.0078028287923799745027,0.014080445062431688752,0.11148338081186362492,-0.17519890952467545575,-0.16037341246782510495,0.053516940734694026793,-0.0076182955612566589584,0.0080155048885003302855,0.014082335572953163724,0.05544370722166287041,-0.010227286601662466739,0.0075888189288366644791,0.02806977847351848146,-0.0066669794441736682927,-0.28950664549245974655,-0.02500620574659756512,-0.076091658888219212975,0.080385980811219504005,-0.066638635922624867014,-0.069340293149601647804,-0.028120213840870201399,0.024730930039756272854,0.04091587479381503939,-0.035269029851852685964,-0.016040141116915332398,0.034460415720834677855,-0.032343612552307526853,-0.0094948370795532362892,0.030344013968137659859,-0.198762757813429225,-0.0048823225092682843648,0.0039502534770592201765,0.048362574930115080629,0.013393440573250769282,-0.22145458110054938583,-0.19235500138098310385,-0.026608098398480488356,0.034670474793239362821,0.082733175140779866008,0.017130802185904878826,0.03394522643636734005,0.017629336734712154622,-0.0037042959710790416411,0.032147658164217995935,0.012665760639399174098,0.018433916871304144997,-0.24528898593296230568,-0.0028402922067837254629,-0.0073739327698965073665,0.00013994104467578291021,-0.10409496633557438483,0.0090202086458439096478,0.031899453263104553258,0.046663622261673524949,-0.016463910118835516083,-0.021477223131905857911,-0.0011474569605627899394,0.031411159901696399099,0.020983452233467765613,-0.0015775976055658303635,-0.0051343884470543173226,0.01498264610217932627,0.017103663617590868923,0.055783151973601743934,0.056739255464736168544,-0.029369973815218931162,0.0076976434715578289161,0.0076976434715578289161,0.0047615348978633327201,0.0047615348978633353222,0.069950996224302786075,0.031415286801778206927,0.022938068118832113246,0.016797847601657908689,0.0019003180112008258729,0.056693426566766361163,0.031410730785386607733,-0.015239372238204576884,-0.011232514915059025815,0.56987778728857563237,0.087063185657421118813],[0.073075711431066350809,0.10007355473000188739,0.11232846484915447183,-0.019026420006591899386,-0.020138706205757490181,0.0036723835995463634946,0.039798782210284877614,-0.081040976584124471693,-0.031343019912083512624,-0.0076173051421001185604,0.0066516803404724185803,0.025596528923534575539,0.0027957366828395262964,-0.016894461486119376897,-0.011665080901892466506,-0.011492601530174837918,-0.12394123564468299825,-0.013414919931976953052,0.0081342948955993327892,0.0076017334382117119837,-0.021445510629157428506,0.17402073091912265146,0.063493743456190160357,-0.024348152762162116047,0.0038672955737375043148,0.15477060371552570084,-0.14152372326044782014,0.0058355627663420547857,0.0069878854808502069776,-0.018230531506652245671,-0.027258140542838246723,-0.0035021521001325022458,0.018702239035896947583,-0.022570044341038000835,-0.025368281043502201311,-0.0019840926968673678644,0.0017789867580576006114,0.016980297697968698561,0.097556963476078936703,0.0068231207371062122316,-0.070633458794543829695,0.0058251767038657586983,-0.17327720138697288998,0.022173782161678663033,0.053041994831402289323,-0.028323387847445619103,0.013859335471237825207,-0.027821686522016227106,-0.029183869765059117923,-0.0966017594294262677,0.24003486827697542716,-0.072689166376665517721,0.018443477133782967131,-0.0075291701037544910696,-0.01467125176729727927,0.0046240605638256972176,0.068872139457127223849,-0.010753192032447711143,0.0019471018917255745843,-0.0004693719179344523016,-0.017567789153778677613,-0.003669088614760409716,0.053375694469367560013,-0.017280331259803261706,0.16437319495589208795,0.036605597350300063397,0.0060978971374993041696,-0.032863926477481458788,0.031827513157391046361,0.028405984490743545201,0.16269733148711293391,-0.0047537749399111902185,-0.0090689577646521878085,-0.014892853331713817172,0.029343936829533377036,0.0067010528467519340709,0.0054374226569908739454,-0.017409195470406150369,-0.0027717006355872180444,-0.031160312606671510677,-0.0289333541841034457,0.11365298187966992038,-0.0066432714185366672013,-0.037232651101378917702,0.00060232141630614890494,-0.0013603792765518028275,-0.029068053933295135566,-0.0022791355900569111592,-0.0048491946912140541232,-0.015910599990206629462,-0.018291726996613470041,0.057464912898099622385,-0.0015906060433239252276,0.03273280497343784845,0.055314509569213771156,0.030525372037407634551,0.015777042616459784063,0.015065397966153521239,-0.038030764464013148973,-0.027375438251817766494,0.026390775201096412089,-2.9706803320265440737e-05,-0.014225903099323566545,0.022918943421440206298,-0.024905912845013433027,-0.059506101100017125272,0.094895670964157102789,-0.008228032317028920184,-0.021650446841649011176,-0.026188601321096766084,-0.0093701003780413804484,0.13263206412623668173,0.089009495160446927553,0.009643519212170045124,0.037846935216895798149,0.029446025254805476001,-0.053995931008535530404,-0.022510932517937246033,-0.012849278362805761564,-0.0079569584584067570843,-0.00056505075902563779884,-0.014688068968918754562,-0.0075688411105989143388,0.031508317497018198394,-0.0084035981536084401744,0.0074278246029942625664,-0.0031145592478914367954,0.16254650620234692426,-0.0050139682610296542123,-0.014139886470108622984,-0.0237911422958496932,0.0084239552897617496485,-0.054307509211872863342,0.0015347546947226365591,-0.038726417448990531345,-0.0066625133791516329487,0.0053819597190832881017,0.0017567349705776412905,-0.0019086881628804864067,-0.0049069227253998714405,-0.023811697590423390458,-0.027107560084792495236,0.006841376413762585533,-0.0082147965596477239003,-0.008214796559647725635,-0.013253988358605002865,-0.013253988358605002865,-0.03064479272614453742,-0.021185276436397757621,-0.013961243440582101968,-0.00063869743072544546414,0.0054785980238036000381,-0.019733264110709677897,-0.0094391582677531022522,0.0078271554319380206438,0.0090554213255601510163,0.41326681054185832043,0.17069596159993502549],[0.026123981194105670017,-0.1456541966338587013,-0.14872313944038453859,0.0065587789147068097789,-0.072845386342795567791,0.00062394595753603862218,-0.10930039889213481741,-0.082611552630679083165,0.014931795078362829557,-0.013285747698927001872,0.12999790032194402656,0.0076153388542448659584,0.045542652332964145279,0.017976518810992620639,0.014360355539311626602,-0.0035593828220677691497,0.04066332182653591143,0.026063569035828852011,0.0093277065769429134273,-0.0064809992619597536767,0.024613284662327178376,-0.11454160442860011893,0.02271594666052473635,-0.0027678168691985254209,0.0069217153371886946597,-0.028872541312108968709,0.23926601798655944275,0.033896649857936562988,0.066385482053727365437,0.011352825962070331803,0.075601447603182714285,-0.023278614473171962973,-0.02969319035463261966,-0.048959676237524583919,-0.070363013454805403701,0.031218383935698649362,-0.029763912817898491997,0.068606563272194540093,-0.24168922711324297703,-0.011764692786738127975,-0.096804621148401992503,0.027612838356751739921,-0.0053309309151953372663,-0.077057756331452356702,0.019416220294413345793,-0.015478610696547974099,-0.015783448089656405833,-0.021090307139695178146,0.052967299644190030117,0.0049777110840782271342,-0.13808816818128055726,-0.10017473404627992573,-0.0036062486035467696856,0.025490393590733993051,0.015309961583248260855,0.0014252416895966036128,-0.018740244181245355182,0.034730993163124411482,0.030138953575211405861,-0.0060843036522484315876,0.0087358967345965068269,-0.012513854238153536425,-0.0018636156976283204528,-0.022360758898233277364,0.20468296723932447034,-0.15226055613850583703,0.050459433965613330331,0.053195909964879752041,-0.12953353016139709797,-0.0019083796644117150768,-0.070310603602893248509,0.011720809816512821333,-0.02913871302437168187,0.02795293039563529966,0.040892014854626179687,-0.0099281690400347417241,0.063728451061790009069,0.010124207189139243848,0.025012826952623148924,0.086909889638408441281,0.033923124064556733903,-0.011739729787318941776,0.0038060080903585371062,0.014633951116312457139,0.009593757879759037821,0.032854144949047758839,0.070615783742128138134,0.045333973829718175741,0.006526456112854735897,-0.02703800843745042537,0.0030089223696798052428,-0.12392919214922960836,-0.064558723760368391664,0.020597261737929532105,0.090746462029578769948,0.03883708594543767989,-0.0066733392686134356681,0.010565448452319376252,-0.093340702419837773274,0.0082011924497056160055,0.015402124481338279674,0.021160377599482124711,0.02206211741225666198,0.060923802636726767656,0.01736042950308750929,0.074718466857544171833,0.062032295112253388325,0.010627191945057165579,0.012368964332951993754,0.012366116453729789765,0.0042482790669011285048,0.024099498485092931549,0.060882482416988202567,-0.023769185623495867749,0.096752222956722214176,-0.08993318935679192605,-0.016795477992868967226,0.0021960504576198757593,-0.0018347158104856512491,0.016395579206574934644,0.017835663162722465575,-0.021917979352131161663,-0.0029654470727207742423,0.034151809210644722137,0.012441700050263829538,0.00093083876944183969147,-0.0047589789581136340835,0.003100024003869461444,0.023221591216764970317,0.029771310311065564413,0.025386147049355375221,-0.014004845454224730886,-0.046849235396914136464,-0.0016497326775027985456,-0.028949812582612859113,-0.025493264740236651344,0.010719189777615153319,-0.0010801611044611426991,0.031046631655316615089,0.021771194257038845726,0.02443074350969553013,0.020625547521574721932,0.0034909808236159287943,0.0032752361974527112454,0.003275236197452710378,0.016034262500493532549,0.016034262500493532549,0.033949983151038427842,0.0078551025254062004088,0.0082796539828928067406,0.026693466654101716262,-0.0011456577204710851475,0.052793666683300703724,0.038814019500435628651,-0.01606135319525483704,-0.0071961159832956483537,-0.57403049137704198479,-0.29613564099661693341]])
    
    
    # Layer 2
    b2 =  np.array([0.10469541316549921262])
    W2 = np.array ([-1.2597807766082367298,0.53908372111789293335,-0.83187568215226304069,-0.62258746964294886528,-1.1211913091006475707,-1.1252235998665112149,0.81937668370229577164,0.87977550360128742302,-0.62545816020641942234,0.59767703130651783638])
    
    
    # Output 1
    Out_ymin = np.array([-1])
    Out_gain =  np.array([0.326424024808226])
    Out_xoffset =  np.array([-1])
    
    
    #======================SIMULATION AND FUNCTIONS===============================================
    
    # Dimensions
    Q = x1.shape[1] # samples
    print("Data Number = ",Q)
    
    # Input 1
    y = x1[...,:] - In_xoffset[...,:]
    y = np.multiply(y,In_gain[...,:])
    y = y + In_ymin[...,:]
    
    
    # Layer 1    #b1expand
    a1=np.repeat(b1,Q,1) + np.dot(W1,y)
    
     
    #Sigmoid Symmetric Transfer Function
    def tanh_function(a1):
        a = (2/(1 + np.exp(-2*a1))) -1
        return a
    
    a1=tanh_function(a1)
        
    #Layer 2
    a2=np.repeat(b2,Q) + np.dot(W2,a1)
    
    
     #Output 1
    x0 = a2-Out_ymin[...,:]
    x0 = x0 / Out_gain[...,:]
    x0 = x0 + Out_xoffset[...,:]
    #print("x0=",x0)
    
    #===============================================================================
    #   Convirtiendo el resultado a lista para el manejo de datos requerido     #
    print(x0)
    
    lst = []
    
    for x in x0:
        lst.append(x)
      
        
    lst=re.sub(",","",str(lst))
    lst=re.sub(" ","\n",lst)
    lst = str(lst)[1:-1] 
       
    print("\nEstimated log10viscosity =\n\n",lst)
    
    #===============================================================================
    ####                          Saving in a CSV                     ######
    
    
    with open("RESULTS.csv","w") as file:
        file.write(lst + "\n")
    
    return lst
